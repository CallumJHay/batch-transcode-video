{"version":3,"sources":["../../lib/say.js"],"names":[],"mappings":"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","file":"say.js","sourcesContent":["import chalk from 'chalk';\nimport options from './options';\nimport Promise from 'promise';\nimport {isString} from './util';\nexport const INFO          = 'INFO';\nexport const ERROR         = 'ERROR';\nexport const DEBUG         = 'DEBUG';\nexport const WRITE         = 'WRITE';\n\nexport function log(obj) {\n  let shouldEmit = true;\n  let fileColor = obj.type === ERROR ? 'yellow' : 'blue';\n  let headerBg;\n  switch (obj.type) {\n    case WRITE:\n      headerBg = 'bgGreen';\n      break;\n    case DEBUG:\n      shouldEmit = options['debug'];\n      headerBg = 'bgBlue';\n      break;\n    case INFO:\n      shouldEmit = !options['quiet'];\n      headerBg = 'bgCyan';\n      break;\n    case ERROR:\n    default:\n      headerBg = 'bgRed';\n      break;\n  }\n  if (!shouldEmit) { return false; }\n  if (obj.message) {\n    let t = chalk.gray.bold(('0' + (obj.time).toLocaleTimeString()).slice(-11) + '  ');\n    let h = chalk[headerBg].gray.bold(' ' + obj.type.toUpperCase() + ' ');\n    let m = chalk.white.bold('  ' + obj.message);\n\n    console.log(chalk[fileColor].bold('  -> ' + obj.file));\n    console.log('    -> ' + t + h + m);\n  }\n  if (obj.additional) {\n    console.log(obj.additional);\n  }\n  return true;\n}\n\nexport function notify(m, t, f, a) {\n  let pkg = m;\n  let type = t || ERROR;\n  if (m == null || isString(m)) {\n    let addt = type === ERROR || options['debug'] ? a : null;\n    pkg = {\n      message: m,\n      type: type,\n      file: f,\n      additional: addt\n    };\n  } else {\n    m.type = m.type || type;\n  }\n  pkg.time = new Date();\n  notify._packages.push(pkg);\n  return pkg;\n}\nnotify._packages = [];\nnotify._fileCount = 0;\nnotify._skipCount = 0;\nnotify._timer = null;\nnotify.stopProgressTimer = function stopProgressTimer() {\n  if (notify._timer !== null) {\n    clearInterval(notify._timer);\n    notify._timer = null;\n  }\n};\n\nexport function getSummary() {\n  let errors = notify._packages.filter(p => p.type === ERROR);\n  let writes = notify._packages.filter(p => p.type === WRITE);\n  let dryRun = options['dry-run'];\n  return {\n    writes: writes,\n    errors: errors,\n    errorCount: errors.length,\n    writeCount: writes.length,\n    skipCount: notify._skipCount,\n    fileCount: notify._fileCount,\n    isDryRun: dryRun,\n    isSuccess: errors.length === 0 && (dryRun || (writes.length > 0 && writes.length === notify._fileCount))\n  };\n}\n\nexport function logSummary(summary) {\n  let plur;\n  console.log(chalk.white.bold('\\n\\n- Batch operation summary...'));\n\n  if (summary.skipCount > 0) {\n    plur = summary.writeCount !== 1 ? 's' : '';\n    console.log(chalk.cyan.bold(`  -> ${summary.skipCount} file${plur} skipped.`));\n  }\n\n  if (summary.writeCount > 0) {\n    plur = summary.writeCount !== 1 ? 's' : '';\n    console.log(chalk.blue.bold(`  -> ${summary.writeCount} file${plur} of ${summary.fileCount} total transcoded.`));\n    if (options['debug']) {\n      summary.writes.forEach((p) => log(p));\n    }\n  } else if (!summary.isDryRun) {\n    console.log(chalk.yellow.bold('  -> No files created.'));\n  }\n\n  if (summary.errorCount > 0) {\n    plur = summary.errorCount !== 1 ? 's' : '';\n    console.log(chalk.yellow.bold(`  -> ${summary.errorCount} file${plur} failed to transcode.`));\n    if (options['debug']) {\n      summary.errors.forEach((p) => log(p));\n    }\n  }\n\n  if (summary.isSuccess) {\n    console.log(chalk.green.bold('  -> Finished without error.'));\n  } else {\n    console.log(chalk.red.bold('  -> Finished with errors.'));\n  }\n}\n"]}